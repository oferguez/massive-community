# GPT-5 + OpenAI Agents SDK + Massive MCP Server — Agentic Financial Analyst Demo

<div align="center">
  <img src="../../../images/logo.png" alt="Project Logo" width="100%"/>
</div>

A simple Python CLI for natural language financial queries using [GPT‑5](https://openai.com/gpt-5/) via the [OpenAI](https://openai.com/) [Agents SDK](https://openai.github.io/openai-agents-python/) and the [Massive](https://massive.com/) [MCP server](https://github.com/massive-com/mcp_massive). It also supports saving analyses as Markdown reports.

## Features

- **Ask questions like:**  
  - `last trade for AAPL`  
  - `aggregates for MSFT from 2024-01-01 to 2024-03-01 daily`  
  - `ticker details TSLA`
  - `analyze the return on investment between microsoft and meta. review news, ratings, earning. save a report`

- **Rich CLI output:**  
  Answers are formatted for easy reading in your terminal.

- **Save Markdown reports:**  
  Ask the agent to save its analysis and it will write a Markdown report under `reports/<category>/...`.

## Disclaimer

**Warning:** The examples, demos, and outputs produced with this project are generated by artificial intelligence and large language models. You acknowledge that this project and any outputs are provided "AS IS", may not always be accurate and may contain material inaccuracies even if they appear accurate because of their level of detail or specificity, outputs may not be error free, accurate, current, complete, or operate as you intended, you should not rely on any outputs or actions without independently confirming their accuracy, and any outputs should not be treated as financial or legal advice. You remain responsible for verifying the accuracy, suitability, and legality of any output before relying on it.

---

## Quickstart (with [uv](https://github.com/astral-sh/uv))

1. **Install uv:**
    ```sh
    curl -Ls https://astral.sh/uv/install.sh | sh
    ```

2. **Clone the repo & enter this example:**
    ```sh
    git clone https://github.com/massive-com/community.git
    cd community/examples/rest/gpt5-openai-agents-sdk-massive-mcp
    ```

3. **Create your `.env`:**
    ```sh
    cp env.example .env
    # Edit .env and set:
    # OPENAI_API_KEY=sk-...
    # MASSIVE_API_KEY=your_massive_api_key_here
    ```
    Both keys are required for the CLI to work.

4. **Sync dependencies from `pyproject.toml`:**
    ```sh
    uv sync
    ```

5. **Run the CLI:**
    ```sh
    uv run main.py
    ```

6. **Type your question and press Enter!**  
   Type `exit` to quit.

---

## Example Usage

```
> last trade for AAPL
✔ Query processed successfully!
Agent Response:
$AAPL last trade: $XXX.XX at 2025-08-13 15:30:00 UTC
---------------------

> exit
Goodbye!
```

For reference, the analysis agent follows instruction steps like:

```
1. Verify finance-related using guardrail
2. Gather market data with Massive tools
3. Include disclaimers
4. Offer to save reports when appropriate
```

Be specific in your prompt. The better the prompt — the better the response.

Putting in `Do a return on investment analysis of Meta vs Microsoft. Review news, sentiment, rating, earnings. Analyze the results. Save a report. ` will result in a report similar to what exists in example.md in the reports folder of this repo.

<div align="center">
  <img src="../gpt5-openai-agents-sdk-massive-mcp/images/example.png" alt="Example" width="100%"/>
</div>

---

## Troubleshooting

- **Missing API Key:**  
  If you see an error about `MASSIVE_API_KEY` or `OPENAI_API_KEY`, make sure your `.env` file is in the same directory and contains both keys:
  ```
  OPENAI_API_KEY=sk-...
  MASSIVE_API_KEY=your_massive_api_key_here
  ```

- **`uvx: command not found`:**  
  Install `uv` with:
  ```sh
  curl -Ls https://astral.sh/uv/install.sh | sh
  ```

- **Dependencies:**  
  If modules are missing, rerun `uv sync` to ensure the virtual environment matches `pyproject.toml`, then execute `uv run main.py`.

- **Guardrail blocks non‑finance prompts:**  
  Try a market or finance-related query.

- **Other errors:**  
  All errors are printed in red in the terminal for easy debugging.

---

## How it Works

- Loads your OpenAI and Massive API keys from `.env`.
- Starts the Massive MCP server over stdio: `uvx --from git+https://github.com/massive-com/mcp_massive@v0.6.0 mcp_massive` (no manual server setup).
- Runs a GPT‑5 analysis agent (OpenAI Agents SDK) with a finance guardrail and tools.
- Can save formatted analyses via `save_analysis_report` to `reports/<category>/...`.
- Persists short‑term session context while the CLI runs and renders rich output.

---

## Enhancements

This demo is a simple one file demonstration to showcase the art of the possible. There are several enhancements that could be made. 

- Multi-agent handoffs: Delegate to specialized agents (news, fundamentals, technicals) for better results.
- LLM context clearing between topic changes
- Stronger guardrails
- Report output models using Pydantic
- Config and limits: YAML/ENV config for model, date-range caps, per-tool rate limits, and retries.

---
## License

This project is licensed under the [MIT License](../../../LICENSE).
